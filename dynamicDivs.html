<html>
<head>
	<title>Dynamic Divs</title>

	<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
	<script>
		var hsl = "hsl(255, 100%, 100%)"
		var createDiv = function(i, color) {
			color = 360 - (360 * (color/980)); //image is backwards from the way it expects

			hsl = "hsl(" + color + ", 50%, " + (100 - ((i/2)/255) * 100) + "%)"; //set it to only go down to 50%

			$('div#container').append("<div id='div" + i + "'></div>");
			$('#div' + i).css("background-color", hsl);
		} 

		$(document).ready(function() {
			$('img#colorPicker').click(function(e) {
				var mousePositionX = e.pageX - $('#colorPicker').offset().left;
							
				$('div#container').empty();
				for (var i = 0; i < 256; i++) {
					setTimeout(function(i) {
					createDiv(i, mousePositionX)}, 10 * i, i);
				}
			});
		});
	</script>

	<style>
		div {height:2px;}
		img {width:980px; height:10px;}
	</style>
</head>

<body>
	Choose a color:
	<br><img id="colorPicker" src="colorfade.jpg">

	<div id="container">
	</div>
</body>
</html>